webpackJsonp([1],{"2/Zf":function(t,e){},"3frG":function(t,e){},"4WnE":function(t,e){},"59ew":function(t,e,s){"use strict";var a=s("Gu7T"),n=s.n(a),i=(s("j/rL"),s("R6hH"),s("vWpI")),o=s.n(i),r=s("qK+J"),c=s.n(r),u=s("ppXU"),l=s("lN2K"),p=s("V/fp"),d=s("pBwn"),h={name:"appList",data:function(){return{articleList:[],page:1,title:{home:"首页",good:"精华",ask:"问答",share:"分享",job:"招聘"},lastTag:"home",crtTag:"home",send:"finish",prompt:!1,promptText:""}},components:{appHeader:u.a,appUtils:l.a,appPrompt:p.a,InfiniteLoading:c.a},created:function(){var t=this.$route.query.tab;this.lastTag=t||"home",this.crtTag=this.lastTag,this.getList(null,o.a.service(this.$loadConfig))},methods:{hide:function(){this.prompt=!1},getList:function(t,e){var s=this;if("loading"!==this.send){this.send="loading",this.lastTag!==this.crtTag&&(this.page=1,this.lastTag=this.crtTag,this.articleList.splice(0));var a="home"===this.crtTag?"":"&tab="+this.crtTag;this.$http.get("topics?page="+this.page+"&limit=20"+a).then(function(a){var i;(i=s.articleList).push.apply(i,n()(a.data.data)),++s.page,s.send="finish",s.page>2&&t.loaded(),e&&e.close()}).catch(function(t){s.send="finish",Object(d.a)(t,s)})}},getTime:d.c,getTag:d.b},beforeRouteUpdate:function(t,e,s){this.crtTag=t.query.tab||"home",this.lastTag=e.query.tab||"home",this.crtTag!==this.lastTag&&this.getList(null,o.a.service(this.$loadConfig)),s()}},m={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("app-header",{attrs:{title:t.title[t.crtTag]}}),t._v(" "),s("ul",{staticClass:"m-list"},[t._l(t.articleList,function(e){return s("li",{key:e.id,staticClass:"article"},[s("h3",{staticClass:"title ellipsis"},[s("router-link",{class:t.getTag(e,t.crtTag),attrs:{to:"/topic/"+e.id,title:e.title}},[t._v("\r\n          "+t._s(e.title))])],1),t._v(" "),s("div",{staticClass:"info"},[s("router-link",{staticClass:"basic",attrs:{to:"/user/"+e.author.loginname}},[s("img",{attrs:{src:e.author.avatar_url,title:e.author.loginname}}),t._v(" "),s("p",{staticClass:"author"},[t._v("\r\n            "+t._s(e.author.loginname)),s("br"),t._v("\r\n            "+t._s(t.getTime(e.create_at))+"\r\n          ")])]),t._v(" "),s("div",{staticClass:"other"},[s("span",{staticClass:"reply"},[t._v(t._s(e.reply_count))]),t._v(" /\r\n          "),s("span",{staticClass:"visit"},[t._v(t._s(e.visit_count))]),s("br"),t._v(" "),s("span",{staticClass:"last-reply"},[t._v(t._s(t.getTime(e.last_reply_at)))])])],1)])}),t._v(" "),t.articleList.length?s("infinite-loading",{on:{infinite:t.getList}}):t._e()],2),t._v(" "),s("app-utils"),t._v(" "),s("app-prompt",{attrs:{show:t.prompt,text:t.promptText},on:{close:t.hide}})],1)},staticRenderFns:[]};var v=s("VU/8")(h,m,!1,function(t){s("la5k")},null,null);e.a=v.exports},"70zE":function(t,e){},"991W":function(t,e){},Abhw:function(t,e){},AoG8:function(t,e){},Cle9:function(t,e){},DWQ0:function(t,e,s){"use strict";var a={name:"userPanel",props:["data","count"],methods:{getTime:s("pBwn").c}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("aside",{staticClass:"m-userpanel"},[a("h4",{staticClass:"u-desc-title"},[t._v("个人信息")]),t._v(" "),a("div",{staticClass:"content"},[a("div",{staticClass:"basic"},[a("img",{staticClass:"avatar",attrs:{src:t.data.avatar_url,alt:t.data.loginname}}),t._v(" "),a("span",{staticClass:"loginname"},[t._v(t._s(t.data.loginname))])]),t._v(" "),a("div",{staticClass:"other"},[a("span",{staticClass:"github"},[t.data.githubUsername?a("a",{attrs:{target:"blank",href:"https://github.com/"+t.data.githubUsername}},[a("img",{attrs:{src:s("zSI2"),alt:"github"}}),t._v("@"+t._s(t.data.githubUsername)+"\r\n        ")]):t._e()]),t._v(" "),a("span",{staticClass:"score"},[t._v("积分："),a("span",[t._v(t._s(t.data.score))])]),t._v(" "),a("span",{staticClass:"collect"},[a("span",[t._v(t._s(t.count))]),t._v(" 个话题收藏")]),t._v(" "),a("span",[t._v("注册时间：")]),t._v(" "),a("span",{staticClass:"time"},[t._v(t._s(t.getTime(t.data.create_at,!0)))])])])])},staticRenderFns:[]};var i=s("VU/8")(a,n,!1,function(t){s("AoG8")},null,null);e.a=i.exports},"Duo/":function(t,e){},JU1R:function(t,e,s){"use strict";(function(t){var a=s("//Fk"),n=s.n(a),i=s("7+uW"),o=s("/ocq"),r=s("59ew"),c=s("wRHM"),u=s("cna2"),l=s("Ywvc"),p=s("z3v4"),d=s("M8Tx"),h=s("pm1S");i.default.use(o.a),e.a=new o.a({mode:"history",base:t,routes:[{path:"/",name:"appList",component:r.a,alias:"/?tab=home"},{path:"/topic/:topicId",name:"appTopic",component:c.a,props:!0},{path:"/login",name:"appLogin",component:l.a},{path:"/user/:userId",name:"appUser",component:u.a,props:!0,children:[{path:":list",name:"appUserList",component:u.a}]},{path:"/my/messages",name:"appMessage",component:h.a},{path:"/create",name:"newTopic",component:p.a},{path:"/edit",name:"editTopic",component:p.a},{path:"/about",name:"about",component:d.a},{path:"*",component:r.a}],scrollBehavior:function(t,e,s){var a={};return t.hash&&t.path!==e.path?(a.selector=t.hash,new n.a(function(t){setTimeout(function(){t(a)},1500)})):s||(t.matched.some(function(t){return t.meta.scrollToTop})?(a.x=0,a.y=0,a):void 0)}})}).call(e,"/")},M8Tx:function(t,e,s){"use strict";var a={name:"about",components:{appHeader:s("ppXU").a}},n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"m-about"},[e("app-header",{attrs:{title:"关于"}}),this._v(" "),this._m(0)],1)},staticRenderFns:[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("dl",[a("dt",[t._v("关于项目")]),t._v(" "),a("dd",[t._v("该项目最初来源于@shinygang的"),a("a",{attrs:{href:"https://github.com/shinygang/Vue-cnodejs",target:"blank"}},[t._v("Vue-cnodejs")]),t._v("，感谢cnodejs社区提供的API。项目依赖了vue2，vue-router，vuex，axios以及一个vue-infinite-loading无限加载组件、element-ui的分页、选择框、加载组件。使用了所有的API，使用提供的API能实现的功能均已实现。")]),t._v(" "),a("dt",[t._v("源码地址")]),t._v(" "),a("dd",[a("a",{attrs:{href:"https://github.com/duxingyu/vue2-cnodejs",target:"blank"}},[a("img",{attrs:{src:s("zSI2"),alt:"github"}}),t._v(" "),a("em",[t._v("https://github.com/duxingyu/vue2-cnodejs")])]),t._v("。\r\n    ")]),t._v(" "),a("dt",[t._v("使用须知")]),t._v(" "),a("dd",[t._v("1. 如果没有accesstoken，根据登录页下方的提示直接进入。")]),t._v(" "),a("dd",[t._v("2. 临时用户只能在客户端测试版块发表话题。")]),t._v(" "),a("dd",[t._v("3. 用户accesstoken使用localStorage存储，临时用户不进行存储。")]),t._v(" "),a("dd",[t._v("4. 体验完整功能："),a("a",{attrs:{href:"https://cnodejs.org"}},[t._v("cnodejs社区原地址")])]),t._v(" "),a("dt",[t._v("项目不足")]),t._v(" "),a("dd",[t._v("1. 社区提供的API有限，一部分功能无法实现。")]),t._v(" "),a("dd",[t._v("2. 简单地做了响应式处理，没有针对移动端进行处理。")]),t._v(" "),a("dd",[t._v("3. 当用户在话题中评论、回复后返回的数据不包含格式化后的内容(markdown => html)，选择了重新获取完整数据插入到最后，使用相应的js可能更好。")]),t._v(" "),a("dd",[t._v("4. 编辑话题时重新请求了未渲染的话题内容, 性能有影响。")]),t._v(" "),a("dd",[t._v("5. 路由跳转后的滚动行为没有处理好，如滚动到锚点。")])])}]};var i=s("VU/8")(a,n,!1,function(t){s("MVaA")},null,null);e.a=i.exports},MVaA:function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});s("zSjX"),s("R6hH");var a=s("mbF2"),n=s.n(a),i=(s("c2o4"),s("yaTr")),o=s.n(i),r=(s("tluU"),s("goqj")),c=s.n(r),u=s("7+uW"),l=s("mtWM"),p=s.n(l),d=s("JU1R"),h=s("fZjL"),m=s.n(h),v=s("NYxO");u.default.use(v.a);var f={store:new v.a.Store({state:{user:{id:"",loginname:"",avatar:"",token:null},mesCount:0,topicMes:{accesstoken:"",topic_id:"",title:"",tab:"",content:""},defaultToken:"aabc3938-ad2f-40c4-aa7c-d4f36181b62a"},mutations:{setUser:function(t,e){m()(e).forEach(function(s){t.user[s]=e[s]})},setCount:function(t,e){t.mesCount+=e},editTopic:function(t,e){m()(e).forEach(function(s){t.topicMes[s]=e[s]})}}})},g={name:"appSelf",computed:{getName:function(){return this.$store.store.state.user.loginname},getAvatar:function(){return this.$store.store.state.user.avatar}},methods:{exitLogin:function(){this.$store.store.commit("setUser",{id:"",loginname:"",avatar:"",token:null});var t=window.localStorage;t.user&&t.removeItem("user")}}},_={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"m-nav-log"},[t.getName?s("div",{staticClass:"in"},[s("div",{staticClass:"head"},[s("router-link",{attrs:{to:"/user/"+t.getName}},[s("img",{attrs:{src:t.getAvatar,alt:t.getName}})]),t._v(" "),s("p",{staticClass:"name"},[t._v(t._s(t.getName))])],1),t._v(" "),s("div",{staticClass:"exit",on:{click:t.exitLogin}},[s("i",{staticClass:"material-icons"},[t._v("exit_to_app")])])]):s("div",{staticClass:"out"},[s("router-link",{attrs:{to:"/login"}},[s("i",{staticClass:"material-icons"},[t._v("account_circle")])])],1)])},staticRenderFns:[]};var T={name:"appBar",data:function(){return{nav:[{text:"首页",router:"/?tab=home",icon:"home"},{text:"精华",router:"/?tab=good",icon:"grade"},{text:"分享",router:"/?tab=share",icon:"share"},{text:"问答",router:"/?tab=ask",icon:"help"},{text:"招聘",router:"/?tab=job",icon:"contact_mail"},{text:"消息",router:"/my/messages",icon:"message"},{text:"关于",router:"/about",icon:"info"}]}},components:{appSelf:s("VU/8")(g,_,!1,function(t){s("bq1V")},null,null).exports},props:["show"],computed:{count:function(){return this.$store.store.state.mesCount}},methods:{toggle:function(){this.$emit("hide")}}},M={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"g-bar"},[s("div",{staticClass:"menu",on:{click:function(e){return e.stopPropagation(),t.toggle(e)}}},[s("i",{staticClass:"material-icons"},[t._v("menu")])]),t._v(" "),s("div",{staticClass:"wrap",class:{show:t.show},on:{click:t.toggle,mousewheel:function(t){t.preventDefault()}}},[s("nav",{staticClass:"m-nav",class:{fold:t.show}},[s("app-self"),t._v(" "),s("ul",{staticClass:"list"},t._l(t.nav,function(e){return s("li",{key:e.text},[s("router-link",{attrs:{to:e.router}},[s("i",{staticClass:"material-icons"},[t._v(t._s(e.icon))]),t._v("\r\n        "+t._s(e.text)+"\r\n        "),"message"===e.icon&&0!==t.count?s("span",{staticClass:"u-list-count"},[t._v(t._s(t.count))]):t._e()])],1)}))],1)])])},staticRenderFns:[]};var b={name:"app",data:function(){return{bar:!1}},created:function(){var t=window.localStorage;t&&t.user&&this.$store.store.commit("setUser",JSON.parse(t.user))},components:{appBar:s("VU/8")(T,M,!1,function(t){s("Duo/")},null,null).exports},methods:{toggleBar:function(t){this.bar=!t&&!this.bar}}},C={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"},on:{click:function(e){t.toggleBar(!0)}}},[s("app-bar",{attrs:{show:t.bar},on:{hide:t.toggleBar}}),t._v(" "),s("div",{staticClass:"g-ct"},[s("router-view")],1)],1)},staticRenderFns:[]};var k=s("VU/8")(b,C,!1,function(t){s("Cle9")},null,null).exports;s("991W"),s("erWL"),s("70zE"),s("2/Zf");p.a.defaults.baseURL="https://cnodejs.org/api/v1/",u.default.prototype.$http=p.a,u.default.prototype.$loadConfig={target:"#app",fullscreen:!1,lock:!0},u.default.use(c.a),u.default.use(o.a),u.default.use(n.a),u.default.config.productionTip=!1,new u.default({el:"#app",store:f,router:d.a,components:{App:k},template:"<App/>"})},Nxn4:function(t,e){},QcEv:function(t,e,s){"use strict";var a={name:"userTopics",data:function(){return{topic:["最近参与的话题","最近创建的话题","我的收藏"]}},props:["topicNum","topicList","userId"],methods:{sendList:function(t){return 3===this.topicNum?t.slice(0,5):t},getMore:function(t){return t.length>5&&3===this.topicNum},getTime:s("pBwn").c}},n={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"m-usertopics"},t._l(3===t.topicNum?t.topic:[t.topic[t.topicNum]],function(e,a){return s("div",{key:e},[s("h4",{staticClass:"u-desc-title"},[t._v("\r\n      "+t._s(e)+"\r\n      "),s("span",{staticClass:"u-list-count"},[t._v(t._s(t.topicList[a].length))]),t._v(" "),3!==t.topicNum?s("router-link",{staticClass:"other",attrs:{to:"/user/"+t.userId}},[t._v("返回用户主页")]):t._e()],1),t._v(" "),t.topicList[a].length?s("ul",[t._l(t.sendList(t.topicList[a]),function(e){return s("li",{key:e.id,staticClass:"list"},[s("router-link",{attrs:{to:"/user/"+e.author.loginname}},[s("img",{staticClass:"avatar",attrs:{src:e.author.avatar_url,title:e.author.loginname,alt:e.author.loginname}})]),t._v(" "),s("router-link",{staticClass:"title ellipsis",attrs:{to:"/topic/"+e.id,title:e.title}},[t._v(t._s(e.title))]),t._v(" "),s("span",{staticClass:"time"},[t._v(t._s(t.getTime(e.last_reply_at)))])],1)}),t._v(" "),t.getMore(t.topicList[a])?s("li",{staticClass:"more"},[s("router-link",{attrs:{to:{name:"appUserList",params:{list:1===a?"topics":"collections"}}}},[t._v("查看更多 >>")])],1):t._e()],2):s("p",{staticClass:"not"},[t._v("无话题")])])}))},staticRenderFns:[]};var i=s("VU/8")(a,n,!1,function(t){s("3frG")},null,null);e.a=i.exports},"R+Uu":function(t,e){},R6hH:function(t,e){},"V/fp":function(t,e,s){"use strict";var a={name:"appPrompt",props:["text","show"],watch:{show:function(){var t=this;this.show&&setTimeout(function(){t.$emit("close")},1500)}}},n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"u-prompt",class:{show:this.show}},[e("div",{staticClass:"prompt-ct",class:{show:this.show}},[e("i",{staticClass:"material-icons"},[this._v("error")]),this._v("\r\n    "+this._s(this.text)+"\r\n  ")])])},staticRenderFns:[]};var i=s("VU/8")(a,n,!1,function(t){s("pUIQ")},null,null);e.a=i.exports},Ywvc:function(t,e,s){"use strict";var a=s("mvHQ"),n=s.n(a),i=s("pBwn"),o=s("ppXU"),r=s("V/fp"),c={name:"loginPage",data:function(){return{token:"",prompt:!1,promptText:""}},components:{appHeader:o.a,appPrompt:r.a},created:function(){var t=this.$store.store.state.user;t.token&&this.$router.replace("/user/"+t.loginname)},directives:{focus:{inserted:function(t){t.focus()}}},computed:{getDefaultToken:function(){return this.$store.store.state.defaultToken}},methods:{hide:function(){this.prompt=!1},post:function(t){var e=this,s=t.trim();if(36!==s.length)return this.promptText="请输入36位 accesstoken",void(this.prompt=!0);this.$http.post("accesstoken",{accesstoken:s}).then(function(t){var a=t.data,n={token:s,loginname:a.loginname,id:a.id,avatar:a.avatar_url};e.getMesCount(s),e.setUser(n)}).catch(function(t){return Object(i.a)(t,e)})},setUser:function(t){this.$store.store.commit("setUser",t);var e=window.localStorage;e&&t.token!==this.getDefaultToken&&e.setItem("user",n()(t)),this.$router.go(-1)},getMesCount:function(t){var e=this;this.$http.get("message/count?accesstoken="+t).then(function(t){e.$store.store.commit("setCount",t.data.data)}).catch(function(t){return Object(i.a)(t,e)})}}},u={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"m-login"},[s("app-header",{attrs:{title:"登录"}}),t._v(" "),s("input",{directives:[{name:"focus",rawName:"v-focus"},{name:"model",rawName:"v-model",value:t.token,expression:"token"}],attrs:{type:"text",placeholder:"请输入36位 accesstoken"},domProps:{value:t.token},on:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.post(t.token)},input:function(e){e.target.composing||(t.token=e.target.value)}}}),t._v(" "),s("button",{staticClass:"submit",attrs:{type:"button"},on:{click:function(e){t.post(t.token)}}},[t._v("提交")]),t._v(" "),s("p",{staticClass:"tip"},[s("span",[t._v("提示：")]),t._v("\r\n    如果没有accesstoken，可以点击\r\n    "),s("a",{on:{click:function(e){e.preventDefault(),t.post(t.getDefaultToken)}}},[t._v("这里")]),t._v("\r\n    进行登录。\r\n  ")]),t._v(" "),s("app-prompt",{attrs:{show:t.prompt,text:t.promptText},on:{close:t.hide}})],1)},staticRenderFns:[]};var l=s("VU/8")(c,u,!1,function(t){s("vpcn")},null,null);e.a=l.exports},ZiBV:function(t,e){},bhRM:function(t,e){},bq1V:function(t,e){},c2o4:function(t,e){},cna2:function(t,e,s){"use strict";s("j/rL"),s("R6hH");var a=s("vWpI"),n=s.n(a),i=s("pBwn"),o=s("lN2K"),r=s("ppXU"),c=s("V/fp"),u=s("DWQ0"),l=s("QcEv"),p={name:"appUser",data:function(){return{userInfo:{},finish:!1,topicList:[],prompt:!1,promptText:"",num:3}},props:["userId"],components:{appUtils:o.a,appPrompt:c.a,appHeader:r.a,userPanel:u.a,userTopics:l.a},created:function(){var t=this.$route.params.list;t&&(this.num="topics"===t?1:2),this.getTopic(this.userId,n.a.service(this.$loadConfig))},methods:{hide:function(){this.prompt=!1},getTopic:function(t,e){var s=this;this.$http.get("user/"+t).then(function(t){s.userInfo=t.data.data,s.topicList.splice(0),s.topicList.push(s.userInfo.recent_replies,s.userInfo.recent_topics),s.getCollect(e)}).catch(function(t){return Object(i.a)(t,s)})},getCollect:function(t){var e=this;this.$http.get("topic_collect/"+this.userInfo.loginname).then(function(s){e.topicList.push(s.data.data),e.finish=!0,t.close()}).catch(function(t){return Object(i.a)(t,e)})},sendList:function(t){return 3===this.num?t:[t[this.num]]}},beforeRouteUpdate:function(t,e,s){t.params.list?this.num="topics"===t.params.list?1:2:(this.num=3,t.params.userId!==e.params.userId&&(this.finish=!1,this.getTopic(t.params.userId,n.a.service(this.$loadConfig)))),s()}},d={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"m-user"},[s("app-header",{attrs:{title:t.userId+" 的主页"}}),t._v(" "),t.finish?s("div",{staticClass:"wrap"},[s("user-panel",{attrs:{data:t.userInfo,count:t.topicList[2].length}}),t._v(" "),s("user-topics",{attrs:{topicNum:t.num,userId:t.userId,topicList:t.sendList(t.topicList)}})],1):t._e(),t._v(" "),s("app-utils"),t._v(" "),s("app-prompt",{attrs:{show:t.prompt,text:t.promptText},on:{close:t.hide}})],1)},staticRenderFns:[]};var h=s("VU/8")(p,d,!1,function(t){s("4WnE")},null,null);e.a=h.exports},erWL:function(t,e){},"j/rL":function(t,e){},lN2K:function(t,e,s){"use strict";var a={name:"appUtils",data:function(){return{token:"",pos:!1,w:window}},created:function(){this.token=this.$store.store.state.user.token,this.w.addEventListener("scroll",this.scroll)},methods:{edit:function(){this.$router.push("/create"),this.token||this.$router.push("/login")},scroll:function(){this.pos=this.w.scrollY>500},top:function(){var t=this,e=this.w,s=e.scrollY/10;this.pos=!1,e.removeEventListener("scroll",this.scroll);var a=null;a=setInterval(function(){e.scrollBy(0,-s),e.scrollY<=0&&(clearInterval(a),e.addEventListener("scroll",t.scroll))},50)}}},n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("transition",{attrs:{name:"utils"}},[e("ul",{staticClass:"u-utils"},[e("transition",{attrs:{name:"top"}},[this.pos?e("li",{staticClass:"item"},[e("i",{staticClass:"material-icons top",on:{click:this.top}},[this._v("arrow_upward")])]):this._e()]),this._v(" "),e("li",{staticClass:"item"},[e("i",{staticClass:"material-icons edit",on:{click:this.edit}},[this._v("edit")])])],1)])},staticRenderFns:[]};var i=s("VU/8")(a,n,!1,function(t){s("y575")},null,null);e.a=i.exports},la5k:function(t,e){},nzZZ:function(t,e){},pBwn:function(t,e,s){"use strict";function a(t,e){if(e)return t.split(/T|\..+/,2).join(" ");var s=(new Date-new Date(t))/6e4,a=s/60,n=a/24,i=n/7,o=i/4,r=o/12;return s<60?(Math.floor(s)>0?Math.floor(s):0)+" 分钟前":a<24?Math.floor(a)+" 小时前":n<7?Math.floor(n)+" 天前":i<4?Math.floor(i)+" 周前":o<12?Math.floor(o)+" 月前":Math.floor(r)+" 年前"}function n(t,e){return t.top?"top":e&&"home"!==e?e:t.good?"good":t.tab}function i(t,e){t.response&&(e.promptText=t.response.data.error_msg,e.prompt=!0)}s.d(e,"c",function(){return a}),s.d(e,"b",function(){return n}),s.d(e,"a",function(){return i})},pUIQ:function(t,e){},pm1S:function(t,e,s){"use strict";var a=s("Gu7T"),n=s.n(a),i=(s("j/rL"),s("R6hH"),s("vWpI")),o=s.n(i),r=s("pBwn"),c=s("lN2K"),u=s("ppXU"),l=s("V/fp"),p=s("DWQ0"),d=s("QcEv"),h={name:"appUser",data:function(){return{mesItem:["新消息","过往消息"],mesList:[],mesType:{reply:"回复",at:"@"},token:"",prompt:!1,promptText:"",finish:!1}},props:["userId"],components:{appUtils:c.a,appPrompt:l.a,appHeader:u.a,userPanel:p.a,userTopics:d.a},created:function(){this.$store.store.state.user.token?(this.token=this.$store.store.state.user.token,this.getMessage(o.a.service(this.$loadConfig))):this.$router.push("/login")},methods:{hide:function(){this.prompt=!1},getMessage:function(t){var e=this;this.$http.get("messages?accesstoken="+this.token).then(function(s){var a=s.data.data;e.mesList.push(a.hasnot_read_messages,a.has_read_messages),e.$set(e.mesList[0],"crtPage",1),e.$set(e.mesList[1],"crtPage",1),e.finish=!0,t.close()}).catch(function(t){return Object(r.a)(t,e)})},changePage:function(){window.scrollTo(0,0)},changeContent:function(t){return t.slice(10*(t.crtPage-1),10*t.crtPage)},markOne:function(t,e){var s=this;0===e&&this.$http.post("message/mark_one/"+t.id,{accesstoken:this.token}).then(function(){s.$store.store.commit("setCount",-1)}).catch(function(t){return Object(r.a)(t,s)}),this.$router.push("/topic/"+t.topic.id+"#a"+t.reply.id)},markAll:function(){var t=this;this.$http.post("message/mark_all",{accesstoken:this.token}).then(function(){var e;t.$store.store.commit("setCount",-t.mesList[0].length),(e=t.mesList[1]).unshift.apply(e,n()(t.mesList[0])),t.mesList[0].splice(0)}).catch(function(e){return Object(r.a)(e,t)})},getTime:r.c}},m={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"m-message"},[s("app-header",{attrs:{title:"个人消息"}}),t._v(" "),t.finish?s("div",{staticClass:"wrap"},[s("div",{staticClass:"m-usermes"},t._l(t.mesItem,function(e,a){return s("div",{key:e},[s("h4",{staticClass:"u-desc-title"},[t._v("\r\n          "+t._s(e)+"\r\n          "),t._v(" "),s("span",{staticClass:"u-list-count"},[t._v(t._s(t.mesList[a].length))]),t._v(" "),0===a?s("button",{staticClass:"other",class:{"mark-not":0===t.mesList[0].length},attrs:{disabled:0===t.mesList[0].length},on:{click:t.markAll}},[t._v("标记全部已读")]):t._e()]),t._v(" "),t.mesList[a].length?s("ul",[t._l(t.changeContent(t.mesList[a]),function(e){return s("li",{key:e.id,staticClass:"list"},[s("p",{staticClass:"title"},[s("router-link",{attrs:{to:"/user/"+e.author.loginname}},[t._v("\r\n                "+t._s(e.author.loginname)+"\r\n              ")]),t._v("于"),s("span",[t._v(t._s(t.getTime(e.reply.create_at)))]),t._v(" 在 "),s("router-link",{attrs:{to:"/topic/"+e.topic.id+"#a"+e.reply.id},nativeOn:{click:function(s){s.preventDefault(),t.markOne(e,a)}}},[t._v(t._s(e.topic.title)+"\r\n              ")]),t._v(" 中"+t._s(t.mesType[e.type])+"了你：\r\n            ")],1),t._v(" "),s("article",{staticClass:"content markdown-body",domProps:{innerHTML:t._s(e.reply.content)}})])}),t._v(" "),t.mesList[a].length>=10?s("li",{staticClass:"e-page"},[s("el-pagination",{attrs:{background:"",layout:"prev, pager, next","current-page":t.mesList[a].crtPage,total:t.mesList[a].length},on:{"update:currentPage":function(e){t.$set(t.mesList[a],"crtPage",e)},"current-change":t.changePage}})],1):t._e()],2):s("p",{staticClass:"not"},[t._v("无消息")])])}))]):t._e(),t._v(" "),s("app-utils"),t._v(" "),s("app-prompt",{attrs:{show:t.prompt,text:t.promptText},on:{close:t.hide}})],1)},staticRenderFns:[]};var v=s("VU/8")(h,m,!1,function(t){s("bhRM")},null,null);e.a=v.exports},ppXU:function(t,e,s){"use strict";var a={render:function(){var t=this.$createElement,e=this._self._c||t;return e("header",{staticClass:"u-header"},[e("h1",{staticClass:"logo"},[e("router-link",{attrs:{to:"/"}},[e("img",{attrs:{src:"https://o4j806krb.qnssl.com/public/images/cnodejs_light.svg",alt:"cnodejs"}})])],1),this._v(" "),e("h2",[this._v("\r\n    "+this._s(this.title)+"\r\n  ")])])},staticRenderFns:[]};var n=s("VU/8")({name:"appHeader",props:["title"]},a,!1,function(t){s("R+Uu")},null,null);e.a=n.exports},rPb9:function(t,e){},tluU:function(t,e){},vpcn:function(t,e){},vrit:function(t,e,s){"use strict";var a={name:"appPublish",props:{at:String,index:Number,btnText:String,small:{type:Boolean,default:!1}},data:function(){return{content:""}},created:function(){this.content=this.at?this.at+" "+this.content:this.content},methods:{sub:function(){this.$emit("reply",this.content,this.index),this.content=""}}},n={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"u-publish"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.content,expression:"content"}],staticClass:"ct",attrs:{placeholder:"支持markdown语法格式"},domProps:{value:t.content},on:{input:function(e){e.target.composing||(t.content=e.target.value)}}}),t._v(" "),s("button",{staticClass:"submit",class:"sub-"+(t.small?"small":"normal"),on:{click:t.sub}},[t._v(t._s(t.btnText))])])},staticRenderFns:[]};var i=s("VU/8")(a,n,!1,function(t){s("nzZZ")},null,null);e.a=i.exports},wRHM:function(t,e,s){"use strict";s("j/rL"),s("R6hH");var a=s("vWpI"),n=s.n(a),i=s("lN2K"),o=s("ppXU"),r=s("V/fp"),c=s("vrit"),u=s("pBwn"),l={name:"topicContent",data:function(){return{send:"before",prompt:!1,promptText:""}},components:{appPrompt:r.a},props:["data","user"],methods:{changeCollect:function(t){var e=this;"loading"!==this.send&&(this.send="loading",this.$http.post("topic_collect/"+(t?"de_collect":"collect"),{accesstoken:this.user.token,topic_id:this.data.id}).then(function(){e.data.is_collect=!t,e.send="before"}).catch(function(t){e.send="before",Object(u.a)(t,e)}))},isAuthor:function(t){return t===this.user.id},editTopic:function(t){var e=this;this.$http.get("topic/"+this.data.id+"?mdrender=false").then(function(s){e.$store.store.commit("editTopic",{accesstoken:e.user.token,topic_id:t.id,title:t.title,tab:t.tab,content:s.data.data.content}),e.$router.push("/edit")}).catch(function(t){return Object(u.a)(t,e)})},hide:function(){this.prompt=!1},getTime:u.c,getTag:u.b}},p={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.data.title?s("div",{staticClass:"m-topic-ct"},[s("div",{staticClass:"intro"},[s("h2",{staticClass:"title",class:t.getTag(t.data)},[t._v(t._s(t.data.title))]),t._v(" "),s("div",{staticClass:"author"},[s("router-link",{attrs:{to:"/user/"+t.data.author.loginname}},[s("img",{attrs:{src:t.data.author.avatar_url,alt:t.data.author.loginname}})]),t._v(" "),s("div",{staticClass:"desc"},[s("p",{staticClass:"name"},[t._v(t._s(t.data.author.loginname))]),t._v(" "),s("p",[s("span",[t._v("发布于 "+t._s(t.getTime(t.data.create_at)))]),t._v(" \r\n          "),s("span",[t._v("阅读 "+t._s(t.data.visit_count))]),t._v(" \r\n          "),s("span",[t._v("评论 "+t._s(t.data.reply_count))])])]),t._v(" "),t.isAuthor(t.data.author_id)?s("button",{staticClass:"collect",on:{click:function(e){t.editTopic(t.data)}}},[t._v("编辑")]):t._e(),t._v(" "),t.user.token?s("button",{staticClass:"collect",class:{cancel:t.data.is_collect},on:{click:function(e){t.changeCollect(t.data.is_collect)}}},[t._v(t._s(t.data.is_collect?"取消收藏":"收藏"))]):t._e()],1)]),t._v(" "),s("div",{staticClass:"body markdown-body",domProps:{innerHTML:t._s(t.data.content)}}),t._v(" "),s("app-prompt",{attrs:{show:t.prompt,text:t.promptText},on:{close:t.hide}})],1):t._e()},staticRenderFns:[]};var d=s("VU/8")(l,p,!1,function(t){s("ZiBV")},null,null).exports,h={name:"topicComment",props:["data","user"],data:function(){return{send:"before",prompt:!1,promptText:""}},components:{appPrompt:r.a,appPublish:c.a},methods:{dealIink:function(t){if("A"===t.target.tagName){var e=t.target.href.split(/\//);e[2]===window.location.host?this.$router.push("/"+e.slice(3).join("/")):window.open(t.target.href)}},isAuthor:function(t){return t===this.data.author.loginname},isUps:function(t){return!!this.user.token&&t.includes(this.user.id)},ups:function(t){var e=this;if(this.user.token)return this.isAuthor(t.author.loginname)?(this.promptText="不能帮自己点赞",void(this.prompt=!0)):void this.$http.post("reply/"+t.id+"/ups",{accesstoken:this.user.token}).then(function(s){return"up"===s.data.action?t.ups.push(e.user.id):t.ups.pop()}).catch(function(t){return Object(u.a)(t,e)});this.$router.push("/login")},hide:function(){this.prompt=!1},reply:function(t,e){this.user.token?this.data.replies[e].show=!t.show:this.$router.push("/login")},subReply:function(t,e){var s=this;if("loading"!==this.send){if(this.send="loading",""===t)return this.prompt=!0,void(this.promptText="回复内容不能为空");var a=t+"\n\n来自 [vue2-cnodejs](https://duxingyu.github.io)";this.$http.post("topic/"+this.data.id+"/replies",{accesstoken:this.user.token,content:a,reply_id:this.data.replies[e].id}).then(function(){s.data.replies[e].show=!1,s.$emit("reget"),s.send="before"}).catch(function(t){Object(u.a)(t,s),s.send="before"})}},getTime:u.c}},m={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"m-topic-comment"},[s("p",{staticClass:"u-desc-title"},[t._v("\r\n    "+t._s(t.data.reply_count)+" 条回复\r\n  ")]),t._v(" "),s("ol",{staticClass:"body",on:{click:function(e){return e.preventDefault(),t.dealIink(e)}}},t._l(t.data.replies,function(e,a){return s("li",{key:a,staticClass:"item",class:{author:t.isAuthor(e.author.loginname)},attrs:{id:"a"+e.id}},[s("div",{staticClass:"info"},[s("router-link",{attrs:{to:"/user/"+e.author.loginname}},[s("img",{attrs:{src:e.author.avatar_url,alt:e.author.loginname}})]),t._v(" "),s("span",{staticClass:"user"},[t._v("\r\n          "+t._s(e.author.loginname)+"\r\n          "+t._s(a+1)+"楼 "+t._s(t.getTime(e.create_at))+"\r\n        ")]),t._v(" "),s("span",[s("i",{staticClass:"material-icons",class:{ups:t.isUps(e.ups)},on:{click:function(s){t.ups(e,a)}}},[t._v("thumb_up")]),t._v("\r\n          "+t._s(e.ups.length||"")+"\r\n          "),s("i",{staticClass:"material-icons",on:{click:function(s){t.reply(e,a)}}},[t._v("comment")])])],1),t._v(" "),s("div",{staticClass:"content"},[s("p",{staticClass:"main markdown-body",domProps:{innerHTML:t._s(e.content)}}),t._v(" "),e.show?s("app-publish",{attrs:{at:"@"+e.author.loginname,index:a,small:!0,btnText:"提交"},on:{reply:t.subReply}}):t._e()],1)])})),t._v(" "),s("app-prompt",{attrs:{show:t.prompt,text:t.promptText},on:{close:t.hide}})],1)},staticRenderFns:[]};var v=s("VU/8")(h,m,!1,function(t){s("Nxn4")},null,null).exports,f={name:"apptopic",props:["topicId"],data:function(){return{data:{},user:null,prompt:!1,promptText:"",send:"before",finish:!1}},components:{appHeader:o.a,appUtils:i.a,appPrompt:r.a,topicContent:d,topicComment:v,appPublish:c.a},created:function(){this.user=this.$store.store.state.user,this.getData(n.a.service(this.$loadConfig))},methods:{hide:function(){this.prompt=!1},getData:function(t){var e=this,s=this.topicId;s=this.user?s+"?accesstoken="+this.user.token:s,this.$http.get("topic/"+s).then(function(s){var a=s.data.data;if(e.data.id){var n=a.replies.length-1;e.data.replies.push(a.replies[n]),e.$set(e.data.replies[n],"show",!1),e.$set(e.data.replies[n],"index",n),++e.data.reply_count,e.$router.push("/topic/"+e.data.id+"#a"+e.data.replies[n].id)}else e.data=a,e.data.replies.forEach(function(t,s){e.$set(t,"show",!1),e.$set(t,"index",s)}),e.finish=!0,t.close()}).catch(function(t){return Object(u.a)(t,e)})},subReply:function(t){var e=this;if("loading"!==this.send){this.send="loading";var s={accesstoken:this.user.token,content:t+"\n        \n来自 [vue2-cnodejs](https://duxingyu.github.io)"};this.$http.post("topic/"+this.topicId+"/replies",s).then(function(){e.getData(),e.send="before"}).catch(function(t){Object(u.a)(t,e),e.send="before"})}}}},g={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"g-topic"},[s("app-header",{attrs:{title:"主题"}}),t._v(" "),s("topic-content",{attrs:{user:t.user,data:t.data}}),t._v(" "),t.data.reply_count?s("topic-comment",{attrs:{user:t.user,data:t.data},on:{reget:t.getData}}):t._e(),t._v(" "),t.user.token&&t.finish?s("p",{staticClass:"u-desc-title"},[t._v("添加回复")]):t._e(),t._v(" "),t.user.token&&t.finish?s("app-publish",{attrs:{btnText:"提交"},on:{reply:t.subReply}}):t._e(),t._v(" "),s("app-utils"),t._v(" "),s("app-prompt",{attrs:{show:t.prompt,text:t.promptText},on:{close:t.hide}})],1)},staticRenderFns:[]};var _=s("VU/8")(f,g,!1,function(t){s("Abhw")},null,null);e.a=_.exports},y575:function(t,e){},z3v4:function(t,e,s){"use strict";var a=s("fZjL"),n=s.n(a),i=s("ppXU"),o=s("vrit"),r=s("V/fp"),c=s("pBwn"),u={name:"newTopic",data:function(){return{options:[{label:"问答",tab:"ask",disabled:!1},{label:"分享",tab:"share",disabled:!1},{label:"招聘",tab:"job",disabled:!1},{label:"测试",tab:"dev",disabled:!1}],type:"",data:{tab:"",title:"",accesstoken:"",content:""},send:"before",prompt:!1,promptText:""}},components:{appHeader:i.a,appPublish:o.a,appPrompt:r.a},created:function(){var t=this,e=this.$store.store.state;this.type="newTopic"===this.$route.name?"new":"edit",e.user.token?(e.user.token===e.defaultToken&&this.options.forEach(function(e,s){"dev"!==e.tab&&(t.options[s].disabled=!0)}),this.data.accesstoken=e.user.token,"edit"===this.type&&n()(e.topicMes).forEach(function(s){t.data[s]=e.topicMes[s]})):this.$router.push("/login")},methods:{addArticle:function(t){var e=this;"loading"!==this.send&&(this.send="loading",this.data.content=t,this.$http.post("topics"+("edit"===this.type?"/update":""),this.data).then(function(t){e.$router.push("/topic/"+t.data.topic_id)}).catch(function(t){Object(c.a)(t,e),e.send="before"}))},hide:function(){this.prompt=!1}}},l={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"m-new-topic"},[s("app-header",{attrs:{title:"new"===t.type?"新建话题":"编辑话题"}}),t._v(" "),s("label",{staticClass:"select",attrs:{for:"select"}},[t._v("选择版块：\r\n    "),s("el-select",{attrs:{placeholder:"请选择",id:"select",size:"small"},model:{value:t.data.tab,callback:function(e){t.$set(t.data,"tab",e)},expression:"data.tab"}},t._l(t.options,function(t){return s("el-option",{key:t.tab,attrs:{label:t.label,value:t.tab,disabled:t.disabled}})}))],1),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.data.title,expression:"data.title"}],staticClass:"title",attrs:{placeholder:"标题字数 10字以上"},domProps:{value:t.data.title},on:{input:function(e){e.target.composing||t.$set(t.data,"title",e.target.value)}}}),t._v(" "),s("app-publish",{attrs:{btnText:"发布",at:t.data.content},on:{reply:t.addArticle}}),t._v(" "),s("app-prompt",{attrs:{show:t.prompt,text:t.promptText},on:{close:t.hide}})],1)},staticRenderFns:[]};var p=s("VU/8")(u,l,!1,function(t){s("rPb9")},null,null);e.a=p.exports},zSI2:function(t,e){t.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNDg5OTAxNTQzNzg0IiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjE2ODEiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTk0MS43MTQgNTEycTAgMTQzLjQzMy04My43MTIgMjU4LjAxMXQtMjE2LjI4MyAxNTguNTc0cS0xNS40MzMgMi44NTMtMjIuNTY1LTMuOTg2dC03LjEzMS0xNy4xNTJ2LTEyMC41NzZxMC01NS40NDItMjkuNjk2LTgxLjE1MiAzMi41ODUtMy40MzggNTguNTg3LTEwLjI3N3Q1My43MjMtMjIuMjcyIDQ2LjI5OS0zNy45OTggMzAuMjgxLTYwLjAxNCAxMS43MDMtODYuMDE2cTAtNjkuMTU3LTQ1LjEyOS0xMTcuNzIzIDIxLjEzOC01Mi4wMDUtNC41NzEtMTE2LjU1My0xNi4wMTgtNS4xNTctNDYuMjk5IDYuMjl0LTUyLjU1MyAyNS4xNjFsLTIxLjcyMyAxMy43MTRxLTUzLjEzOC0xNC44NDgtMTA5LjcxNC0xNC44NDh0LTEwOS43MTQgMTQuODQ4cS05LjE0My02LjI5LTI0LjI4My0xNS40MzN0LTQ3LjcyNi0yMi4wMTYtNDkuMTUyLTcuNzE3cS0yNS4xNjEgNjQuNTg1LTMuOTg2IDExNi41NTMtNDUuMTI5IDQ4LjU2Ny00NS4xMjkgMTE3LjcyMyAwIDQ4LjU2NyAxMS43MDMgODUuNzIzdDI5Ljk4OSA2MC4wMTQgNDYuMDA3IDM4LjI5IDUzLjcyMyAyMi4yNzIgNTguNTg3IDEwLjI3N3EtMjIuODU3IDIwLjU1My0yOC4wMTQgNTguODQzLTExLjk5NSA1LjcwNS0yNS43MSA4LjU1OHQtMzIuNTg1IDIuODUzLTM3LjQxMy0xMi4yODgtMzEuNzA3LTM1LjczcS0xMC44NjItMTguMjg2LTI3LjcyMS0yOS42OTZ0LTI4LjI3LTEzLjcxNGwtMTEuNDQ3LTEuNzE5cS0xMS45OTUgMC0xNi41NjcgMi41NnQtMi44NTMgNi41ODMgNS4xNTcgOC4wMDkgNy40MjQgNi44MzlsMy45ODYgMi44NTNxMTIuNTgxIDUuNzA1IDI0Ljg2OSAyMS43MjN0MTcuOTkzIDI5LjE0N2w1LjcwNSAxMy4xMjlxNy40MjQgMjEuNzIzIDI1LjE2MSAzNS4xNDV0MzguMjkgMTcuMTUyIDM5LjcxNyAzLjk4NiAzMS43MDctMi4wMTFsMTMuMTI5LTIuMzA0cTAgMjEuNzIzIDAuMjkzIDUwLjg3MXQwLjI5MyAzMC44NjZxMCAxMC4yNzctNy40MjQgMTcuMTUydC0yMi44NTcgMy45ODZxLTEzMi41NzEtNDMuOTk1LTIxNi4yODMtMTU4LjU3NHQtODMuNzEyLTI1OC4wMTFxMC0xMTkuNDQyIDU4Ljg0My0yMjAuMjd0MTU5LjcwNy0xNTkuNzA3IDIyMC4yNy01OC44NDMgMjIwLjI3IDU4Ljg0MyAxNTkuNzA3IDE1OS43MDcgNTguODQzIDIyMC4yN3oiIHAtaWQ9IjE2ODIiPjwvcGF0aD48L3N2Zz4="},zSjX:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.4bc7f538ffd1738d1ef5.js.map