(function(root,factory){if(typeof define==='function'&&define.amd){define([],factory)}else if(typeof module==='object'&&module.exports){module.exports=factory()}else{root._=factory()}}(this,function(){var _={};var inherits=_.inherits=(function(exports){exports=function(Class,SuperClass){if(objCreate)return(Class.prototype=objCreate(SuperClass.prototype));noop.prototype=SuperClass.prototype;Class.prototype=new noop()};var objCreate=Object.create;function noop(){}return exports})({});var isBrowser=_.isBrowser=(function(exports){exports=typeof window==='object'&&typeof document==='object'&&document.nodeType===9;return exports})({});var isObj=_.isObj=(function(exports){exports=function(val){var type=typeof val;return!!val&&(type==='function'||type==='object')};return exports})({});var has=_.has=(function(exports){var hasOwnProp=Object.prototype.hasOwnProperty;exports=function(obj,key){return hasOwnProp.call(obj,key)};return exports})({});var isUndef=_.isUndef=(function(exports){exports=function(val){return val===void 0};return exports})({});var root=_.root=(function(exports){exports=isBrowser?window:global;return exports})({});var detectMocha=_.detectMocha=(function(exports){exports=function(){for(var i=0,len=methods.length;i<len;i++){var method=methods[i];if(typeof root[method]!=='function')return false}return true};var methods=['afterEach','after','beforeEach','before','describe','it'];return exports})({});var keys=_.keys=(function(exports){if(Object.keys&&!detectMocha()){exports=Object.keys}else{exports=function(obj){var ret=[];for(var key in obj){if(has(obj,key))ret.push(key)}return ret}}return exports})({});_.detectOs=(function(exports){exports=function(ua){ua=ua||(isBrowser?navigator.userAgent:'');ua=ua.toLowerCase();if(detect('windows phone'))return'windows phone';if(detect('win'))return'windows';if(detect('android'))return'android';if(detect('ipad')||detect('iphone')||detect('ipod'))return'ios';if(detect('mac'))return'os x';if(detect('linux'))return'linux';function detect(keyword){return ua.indexOf(keyword)>-1}return'unknown'};return exports})({});var optimizeCb=_.optimizeCb=(function(exports){exports=function(fn,ctx,argCount){if(isUndef(ctx))return fn;switch(argCount==null?3:argCount){case 1:return function(val){return fn.call(ctx,val)};case 3:return function(val,idx,collection){return fn.call(ctx,val,idx,collection)};case 4:return function(accumulator,val,idx,collection){return fn.call(ctx,accumulator,val,idx,collection)}}return function(){return fn.apply(ctx,arguments)}};return exports})({});var types=_.types=(function(exports){exports={};return exports})({});var identity=_.identity=(function(exports){exports=function(val){return val};return exports})({});var objToStr=_.objToStr=(function(exports){var ObjToStr=Object.prototype.toString;exports=function(val){return ObjToStr.call(val)};return exports})({});var isArgs=_.isArgs=(function(exports){exports=function(val){return objToStr(val)==='[object Arguments]'};return exports})({});var isArr=_.isArr=(function(exports){exports=Array.isArray||function(val){return objToStr(val)==='[object Array]'};return exports})({});var castPath=_.castPath=(function(exports){exports=function(str,obj){if(isArr(str))return str;if(obj&&has(obj,str))return[str];var ret=[];str.replace(regPropName,function(match,number,quote,str){ret.push(quote?str.replace(regEscapeChar,'$1'):number||match)});return ret};var regPropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g;var regEscapeChar=/\\(\\)?/g;return exports})({});var safeGet=_.safeGet=(function(exports){exports=function(obj,path){path=castPath(path,obj);var prop;prop=path.shift();while(!isUndef(prop)){obj=obj[prop];if(obj==null)return;prop=path.shift()}return obj};return exports})({});var isFn=_.isFn=(function(exports){exports=function(val){var objStr=objToStr(val);return(objStr==='[object Function]'||objStr==='[object GeneratorFunction]'||objStr==='[object AsyncFunction]')};return exports})({});var getProto=_.getProto=(function(exports){var getPrototypeOf=Object.getPrototypeOf;var ObjectCtr={}.constructor;exports=function(obj){if(!isObj(obj))return null;if(getPrototypeOf)return getPrototypeOf(obj);var proto=obj.__proto__;if(proto||proto===null)return proto;if(isFn(obj.constructor))return obj.constructor.prototype;if(obj instanceof ObjectCtr)return ObjectCtr.prototype;return null};return exports})({});var isMiniProgram=_.isMiniProgram=(function(exports){exports=typeof wx!=='undefined'&&isFn(wx.openLocation);return exports})({});var isNum=_.isNum=(function(exports){exports=function(val){return objToStr(val)==='[object Number]'};return exports})({});var isArrLike=_.isArrLike=(function(exports){var MAX_ARR_IDX=Math.pow(2,53)-1;exports=function(val){if(!val)return false;var len=val.length;return isNum(len)&&len>=0&&len<=MAX_ARR_IDX&&!isFn(val)};return exports})({});var each=_.each=(function(exports){exports=function(obj,iterator,ctx){iterator=optimizeCb(iterator,ctx);var i,len;if(isArrLike(obj)){for(i=0,len=obj.length;i<len;i++){iterator(obj[i],i,obj)}}else{var _keys=keys(obj);for(i=0,len=_keys.length;i<len;i++){iterator(obj[_keys[i]],_keys[i],obj)}}return obj};return exports})({});var createAssigner=_.createAssigner=(function(exports){exports=function(keysFn,defaults){return function(obj){each(arguments,function(src,idx){if(idx===0)return;var keys=keysFn(src);each(keys,function(key){if(!defaults||isUndef(obj[key]))obj[key]=src[key]})});return obj}};return exports})({});var extendOwn=_.extendOwn=(function(exports){exports=createAssigner(keys);return exports})({});var isStr=_.isStr=(function(exports){exports=function(val){return objToStr(val)==='[object String]'};return exports})({});var isEmpty=_.isEmpty=(function(exports){exports=function(val){if(val==null)return true;if(isArrLike(val)&&(isArr(val)||isStr(val)||isArgs(val))){return val.length===0}return keys(val).length===0};return exports})({});var isMatch=_.isMatch=(function(exports){exports=function(obj,src){var _keys=keys(src);var len=_keys.length;if(obj==null)return!len;obj=Object(obj);for(var i=0;i<len;i++){var key=_keys[i];if(src[key]!==obj[key]||!(key in obj))return false}return true};return exports})({});var isNode=_.isNode=(function(exports){exports=typeof process!=='undefined'&&objToStr(process)==='[object process]';return exports})({});var ltrim=_.ltrim=(function(exports){var regSpace=/^\s+/;exports=function(str,chars){if(chars==null)return str.replace(regSpace,'');var start=0;var len=str.length;var charLen=chars.length;var found=true;var i;var c;while(found&&start<len){found=false;i=-1;c=str.charAt(start);while(++i<charLen){if(c===chars[i]){found=true;start++;break}}}return start>=len?'':str.substr(start,len)};return exports})({});var matcher=_.matcher=(function(exports){exports=function(attrs){attrs=extendOwn({},attrs);return function(obj){return isMatch(obj,attrs)}};return exports})({});var safeCb=_.safeCb=(function(exports){exports=function(val,ctx,argCount){if(val==null)return identity;if(isFn(val))return optimizeCb(val,ctx,argCount);if(isObj(val))return matcher(val);return function(key){return function(obj){return obj==null?undefined:obj[key]}}};return exports})({});var filter=_.filter=(function(exports){exports=function(obj,predicate,ctx){var ret=[];predicate=safeCb(predicate,ctx);each(obj,function(val,idx,list){if(predicate(val,idx,list))ret.push(val)});return ret};return exports})({});var unique=_.unique=(function(exports){exports=function(arr,compare){compare=compare||isEqual;return filter(arr,function(item,idx,arr){var len=arr.length;while(++idx<len){if(compare(item,arr[idx]))return false}return true})};function isEqual(a,b){return a===b}return exports})({});var allKeys=_.allKeys=(function(exports){var getOwnPropertyNames=Object.getOwnPropertyNames;var getOwnPropertySymbols=Object.getOwnPropertySymbols;exports=function(obj){var _ref=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},_ref$prototype=_ref.prototype,prototype=_ref$prototype===void 0?true:_ref$prototype,_ref$unenumerable=_ref.unenumerable,unenumerable=_ref$unenumerable===void 0?false:_ref$unenumerable,_ref$symbol=_ref.symbol,symbol=_ref$symbol===void 0?false:_ref$symbol;var ret=[];if((unenumerable||symbol)&&getOwnPropertyNames){var getKeys=keys;if(unenumerable&&getOwnPropertyNames)getKeys=getOwnPropertyNames;do{ret=ret.concat(getKeys(obj));if(symbol&&getOwnPropertySymbols){ret=ret.concat(getOwnPropertySymbols(obj))}}while(prototype&&(obj=getProto(obj))&&obj!==Object.prototype);ret=unique(ret)}else{if(prototype){for(var key in obj){ret.push(key)}}else{ret=keys(obj)}}return ret};return exports})({});var extend=_.extend=(function(exports){exports=createAssigner(allKeys);return exports})({});_.clone=(function(exports){exports=function(obj){if(!isObj(obj))return obj;return isArr(obj)?obj.slice():extend({},obj)};return exports})({});var map=_.map=(function(exports){exports=function(obj,iterator,ctx){iterator=safeCb(iterator,ctx);var _keys=!isArrLike(obj)&&keys(obj);var len=(_keys||obj).length;var results=Array(len);for(var i=0;i<len;i++){var curKey=_keys?_keys[i]:i;results[i]=iterator(obj[curKey],curKey,obj)}return results};return exports})({});var toArr=_.toArr=(function(exports){exports=function(val){if(!val)return[];if(isArr(val))return val;if(isArrLike(val)&&!isStr(val))return map(val);return[val]};return exports})({});var Class=_.Class=(function(exports){exports=function(methods,statics){return Base.extend(methods,statics)};function makeClass(parent,methods,statics){statics=statics||{};var className=methods.className||safeGet(methods,'initialize.name')||'';delete methods.className;var ctor;if(isMiniProgram){ctor=function(){var args=toArr(arguments);return this.initialize?this.initialize.apply(this,args)||this:this}}else{ctor=new Function('toArr','return function '+className+'(){var args = toArr(arguments);return this.initialize ? this.initialize.apply(this, args) || this : this;};')(toArr)}inherits(ctor,parent);ctor.prototype.constructor=ctor;ctor.extend=function(methods,statics){return makeClass(ctor,methods,statics)};ctor.inherits=function(Class){inherits(ctor,Class)};ctor.methods=function(methods){extend(ctor.prototype,methods);return ctor};ctor.statics=function(statics){extend(ctor,statics);return ctor};ctor.methods(methods).statics(statics);return ctor}var Base=(exports.Base=makeClass(Object,{className:'Base',callSuper:function(parent,name,args){var superMethod=parent.prototype[name];return superMethod.apply(this,args)},toString:function(){return this.constructor.name}}));return exports})({});var mapObj=_.mapObj=(function(exports){exports=function(obj,iterator,ctx){iterator=safeCb(iterator,ctx);var _keys=keys(obj);var len=_keys.length;var ret={};for(var i=0;i<len;i++){var curKey=_keys[i];ret[curKey]=iterator(obj[curKey],curKey,obj)}return ret};return exports})({});_.cloneDeep=(function(exports){exports=function(obj){if(isArr(obj)){return obj.map(function(val){return exports(val)})}if(isObj(obj)&&!isFn(obj)){return mapObj(obj,function(val){return exports(val)})}return obj};return exports})({});var random=_.random=(function(exports){exports=function(min,max,floating){if(max==null){max=min;min=0}var rand=Math.random();if(floating||min%1||max%1){return Math.min(min+rand*(max-min+parseFloat('1e-'+((rand+'').length-1))),max)}return min+Math.floor(rand*(max-min+1))};return exports})({});var randomBytes=_.randomBytes=(function(exports){exports=function(size){var ret=new Uint8Array(size);for(var i=0;i<size;i++){ret[i]=random(0,255)}return ret};var crypto;if(isBrowser){crypto=window.crypto||window.msCrypto;if(crypto){exports=function(size){var ret=new Uint8Array(size);crypto.getRandomValues(ret);return ret}}}else if(isNode){crypto=require('crypto');exports=function(size){return crypto.randomBytes(size)}}return exports})({});_.randomItem=(function(exports){exports=function(arr){return arr[random(0,arr.length-1)]};return exports})({});var rtrim=_.rtrim=(function(exports){var regSpace=/\s+$/;exports=function(str,chars){if(chars==null)return str.replace(regSpace,'');var end=str.length-1;var charLen=chars.length;var found=true;var i;var c;while(found&&end>=0){found=false;i=-1;c=str.charAt(end);while(++i<charLen){if(c===chars[i]){found=true;end--;break}}}return end>=0?str.substring(0,end+1):''};return exports})({});var trim=_.trim=(function(exports){var regSpace=/^\s+|\s+$/g;exports=function(str,chars){if(chars==null)return str.replace(regSpace,'');return ltrim(rtrim(str,chars),chars)};return exports})({});var query=_.query=(function(exports){exports={parse:function(str){var ret={};str=trim(str).replace(regIllegalChars,'');each(str.split('&'),function(param){var parts=param.split('=');var key=parts.shift(),val=parts.length>0?parts.join('='):null;key=decodeURIComponent(key);val=decodeURIComponent(val);if(isUndef(ret[key])){ret[key]=val}else if(isArr(ret[key])){ret[key].push(val)}else{ret[key]=[ret[key],val]}});return ret},stringify:function(obj,arrKey){return filter(map(obj,function(val,key){if(isObj(val)&&isEmpty(val))return'';if(isArr(val))return exports.stringify(val,key);return((arrKey?encodeURIComponent(arrKey):encodeURIComponent(key))+'='+encodeURIComponent(val))}),function(str){return str.length>0}).join('&')}};var regIllegalChars=/^(\?|#|&)/g;return exports})({});_.Url=(function(exports){exports=Class({className:'Url',initialize:function(url){if(!url&&isBrowser)url=window.location.href;extend(this,exports.parse(url||''))},setQuery:function(name,val){var query=this.query;if(isObj(name)){each(name,function(val,key){query[key]=val})}else{query[name]=val}return this},rmQuery:function(name){var query=this.query;if(!isArr(name))name=toArr(name);each(name,function(key){delete query[key]});return this},toString:function(){return exports.stringify(this)}},{parse:function(url){var ret={protocol:'',auth:'',hostname:'',hash:'',query:{},port:'',pathname:'',slashes:false};var rest=trim(url);var slashes=false;var proto=rest.match(regProto);if(proto){proto=proto[0];ret.protocol=proto.toLowerCase();rest=rest.substr(proto.length)}if(proto){slashes=rest.substr(0,2)==='//';if(slashes){rest=rest.slice(2);ret.slashes=true}}if(slashes){var host=rest;var hostEnd=-1;for(var i=0,len=hostEndingChars.length;i<len;i++){var pos=rest.indexOf(hostEndingChars[i]);if(pos!==-1&&(hostEnd===-1||pos<hostEnd))hostEnd=pos}if(hostEnd>-1){host=rest.slice(0,hostEnd);rest=rest.slice(hostEnd)}var atSign=host.lastIndexOf('@');if(atSign!==-1){ret.auth=decodeURIComponent(host.slice(0,atSign));host=host.slice(atSign+1)}ret.hostname=host;var port=host.match(regPort);if(port){port=port[0];if(port!==':')ret.port=port.substr(1);ret.hostname=host.substr(0,host.length-port.length)}}var hash=rest.indexOf('#');if(hash!==-1){ret.hash=rest.substr(hash);rest=rest.slice(0,hash)}var queryMark=rest.indexOf('?');if(queryMark!==-1){ret.query=query.parse(rest.substr(queryMark+1));rest=rest.slice(0,queryMark)}ret.pathname=rest||'/';return ret},stringify:function(obj){var ret=obj.protocol+(obj.slashes?'//':'')+(obj.auth?encodeURIComponent(obj.auth)+'@':'')+obj.hostname+(obj.port?':'+obj.port:'')+obj.pathname;if(!isEmpty(obj.query))ret+='?'+query.stringify(obj.query);if(obj.hash)ret+=obj.hash;return ret}});var regProto=/^([a-z0-9.+-]+:)/i;var regPort=/:[0-9]*$/;var hostEndingChars=['/','?','#'];return exports})({});_.uuid=(function(exports){exports=function(){var b=randomBytes(16);b[6]=(b[6]&0x0f)|0x40;b[8]=(b[8]&0x3f)|0x80;return(hexBytes[b[0]]+hexBytes[b[1]]+hexBytes[b[2]]+hexBytes[b[3]]+'-'+hexBytes[b[4]]+hexBytes[b[5]]+'-'+hexBytes[b[6]]+hexBytes[b[7]]+'-'+hexBytes[b[8]]+hexBytes[b[9]]+'-'+hexBytes[b[10]]+hexBytes[b[11]]+hexBytes[b[12]]+hexBytes[b[13]]+hexBytes[b[14]]+hexBytes[b[15]])};var hexBytes=[];for(var i=0;i<256;i++){hexBytes[i]=(i+0x100).toString(16).substr(1)}return exports})({});return _}));